(window.webpackJsonp=window.webpackJsonp||[]).push([["addDeputy"],{"Gm1/":function(e,s,o){"use strict";o.r(s);var t=o("EVdn");function a(e,s){for(var o=0;o<s.length;o++){var t=s[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}var d=o.n(t).a,n=function(){function e(){!function(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings={postcodeSearchUrl:"/postcode-lookup",fieldMappings:{line1:"addressLine1",line2:"addressLine2",line3:"addressTown",postcode:"addressPostcode"}}}var s,o,t;return s=e,(o=[{key:"cacheEls",value:function(e){this.$form=d(e),this.$addressWrapper=d(".address-wrapper",e),this.$postCodeResultsWrapper=d(".postcode-lookup__results",e),this.$postcodeLabel=d('label[for="postcode-lookup"]',e)}},{key:"bindEvents",value:function(){this.$form.on("click.GOVUK.PostcodeLookup",".js-PostcodeLookup__search-btn",this.searchClicked.bind(this)),this.$form.on("click.GOVUK.PostcodeLookup",".js-PostcodeLookup__toggle-address",this.addressToggleClicked.bind(this)),this.$form.on("change.moj.Modules.PostcodeLookup",".js-PostcodeLookup__search-results",this.resultsChanged.bind(this))}},{key:"addressToggleClicked",value:function(e){e.preventDefault(),this.$addressWrapper.show()}},{key:"searchClicked",value:function(e){var s=d(e.target);return this.query=this.$form.find(".js-PostcodeLookup__query").val(),s.hasClass("govuk-button--disabled")||(""!==this.query?(this.findPostcode(this.query),s.addClass("govuk-button--disabled"),this.$postcodeLabel.children(".govuk-error-message").remove()):(this.$postcodeLabel.children(".govuk-error-message").remove(),this.$postcodeLabel.append("<span class='govuk-error-message'>Please enter a postcode</span>"))),!1}},{key:"findPostcode",value:function(e){d.ajax({url:this.settings.postcodeSearchUrl,data:{postcode:e},dataType:"json",timeout:1e4,cache:!0,error:this.postcodeError.bind(this),success:this.postcodeSuccess.bind(this)})}},{key:"postcodeError",value:function(e,s,o){var t="There was a problem: ";this.$form.find(".js-PostcodeLookup__search-btn").removeClass("govuk-button--disabled"),t+="timeout"===s?"the service did not respond in the allotted time":o,alert(t)}},{key:"postcodeSuccess",value:function(e){if(e.success&&null!==e.addresses){var s=this.$form.find(".js-PostcodeLookup__search-results");s.length>0&&(s.find("option").not(":first").remove(),e.addresses.forEach(function(e,o){s.append('<option value="'+o+'" data-line1="'+e.addressLine1+'" data-line2="'+e.addressLine2+'" data-line3="'+e.addressTown+'" data-postcode="'+e.addressPostcode+'">'+e.description+"</option>")}),s.focus(),this.$postCodeResultsWrapper.removeClass("govuk-visually-hidden"))}else{var o=this.$form.find(".js-PostcodeLookup__search"),t=d('label[for="postcode-lookup"]');e.isPostcodeValid?(o.addClass("error"),t.children(".error-message").remove(),this.$postcodeLabel.append("<span class='govuk-error-message'>No address found for this postcode. Please try again or enter the address manually.</span>")):this.$postcodeLabel.append("<span class='govuk-error-message'>Please enter a a valid UK postcode</span>")}this.$form.find(".js-PostcodeLookup__search-btn").removeClass("govuk-button--disabled")}},{key:"resultsChanged",value:function(e){var s=d(e.target).find(":selected");d('[name*="'+this.settings.fieldMappings.line1+'"]').val(s.data("line1")),d('[name*="'+this.settings.fieldMappings.line2+'"]').val(s.data("line2")),d('[name*="'+this.settings.fieldMappings.line3+'"]').val(s.data("line3")),d('[name*="'+this.settings.fieldMappings.postcode+'"]').val(s.data("postcode")).change(),this.$addressWrapper.show()}}])&&a(s.prototype,o),t&&a(s,t),e}();window.addEventListener("DOMContentLoaded",function(e){var s=new n;s.cacheEls(".js-PostcodeLookup"),s.bindEvents()})}},[["Gm1/","runtime",0]]]);