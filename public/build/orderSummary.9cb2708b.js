(window.webpackJsonp=window.webpackJsonp||[]).push([["orderSummary"],{uwo0:function(e,t,o){"use strict";o.r(t);var n=o("EVdn"),r=o.n(n),i=o("nmqf"),d=o.n(i);function a(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=r.a,c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings={dropZone:{addRoute:"/order/{orderId}/document/{docType}",removeRoute:"/order/{orderId}/document/{id}",acceptedFiles:"image/jpeg,image/png,image/tiff,application/pdf,.doc,.docx,.tif",createImageThumbnails:!1,removeElement:'<a href="#" class="dropzone__file-remove">Remove</a>'}}}var t,o,n;return t=e,(o=[{key:"cacheEls",value:function(){this.$documentMandatory=s("#documents-mandatory"),this.$documentOther=s("#documents-additional"),this.$dropZoneTemplate=s("#dropzone__template"),this.$dropZoneFileTemplate=s("#dropzone__template__file")}},{key:"init",value:function(){this.initDropZone(),this.setupDocumentMandatoryUpload(),this.setupDocumentOtherUpload()}},{key:"initDropZone",value:function(){d.a.autoDiscover=!1,this.settings.dropZone.previewTemplate=this.$dropZoneFileTemplate.html(),this.settings.dropZone.readyToServe=this.readyToServe(),this.settings.dropZone.handleRemoveAction=this.handleRemoveAction(),this.settings.dropZone.init=function(){this.on("addedfile",function(e){var t=this.options.maxFiles;null!==t&&this.files.length>t&&this.removeFile(this.files[0]),e.addRemoveButton&&this.options.handleRemoveAction(e,this)}),this.on("error",function(e,t){var o=this,n=d.a.createElement(o.options.removeElement);n.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),o.removeFile(e)}),s(e.previewElement).find(".dz-progress").hide(),s(e.previewElement).find(".dz-filename").append(n)}),this.on("success",function(e,t){e.id=t.id,e.orderId=t.orderId,this.options.readyToServe(e,t),this.options.handleRemoveAction(e,this)})}}},{key:"handleRemoveAction",value:function(){return function(e,t){var o=d.a.createElement(t.options.removeElement);o.addEventListener("click",function(o){var n=s(this);o.preventDefault(),o.stopPropagation(),n.hide(),s(e.previewElement).find(".dz-progress").show(),s(e.previewElement).find(".dz-upload").css("width","100%"),s.ajax({url:t.options.removeRoute.replace("{orderId}",e.orderId).replace("{id}",e.id),type:"DELETE",success:function(o){o.success?(t.removeFile(e),t.options.readyToServe(e,o)):(n.show(),console.log("Failed to remove document"))},error:function(e){n.show(),console.log("Failed to remove document")}})}),s(e.previewElement).find(".dz-filename").append(o)}}},{key:"readyToServe",value:function(){return function(e,t){var o=s("#serve_order_notice"),n=s("#serve_order_button_disabled");t.readyToServe?(o.addClass("govuk-visually-hidden"),n.removeAttr("disabled").click(function(){window.location.href=s(this).data("path")})):(o.removeClass("govuk-visually-hidden"),n.prop("disabled",!0),n.unbind())}}},{key:"processExistingDocument",value:function(e,t){t.addRemoveButton=!0,e[0].dropzone.files.push(t),e[0].dropzone.emit("addedfile",t),e[0].dropzone.emit("complete",t);var o=e[0].dropzone.files.slice().pop(),n=s(o.previewTemplate);s(".dz-size",n).remove(),s(o.previewElement).find(".dz-progress").hide()}},{key:"setupDocumentMandatoryUpload",value:function(){var e=this,t=s.extend({},e.settings.dropZone);s("[data-doc-type]",e.$documentMandatory).each(function(){var o=s(this).data("order-id"),n=s(this).data("doc-id"),r=s(this).data("doc-type"),i=s("td",this).eq(0).text(),d=s("td",this).eq(1).text(),a="dropZone-"+r,c=e.$dropZoneTemplate.clone().attr("id",a).attr("data-inline-doc-type",r).addClass("dropzone dropzone--multiple"),l=s(".dropzone__template__instruction",c),p=s(".govuk-button--secondary",c);l.html(l.html().replace("other relevant documents","<strong>"+i+"</strong>")),p.text(p.text().replace("documents","document")),t.url=t.addRoute.replace("{orderId}",o).replace("{docType}",r),t.maxFiles=1,e.$documentMandatory.before(c);var u=c.dropzone(t);(d=(d=d.replace(/\n/g," ")).trim())&&"-"!==d&&e.processExistingDocument(u,{id:n,orderId:o,name:d})})}},{key:"setupDocumentOtherUpload",value:function(){var e=this,t=s(e.$documentOther).data("order-id"),o=s(e.$documentOther).data("doc-type"),n=s.extend({},e.settings.dropZone),r="dropZone-"+o,i=e.$dropZoneTemplate.clone().attr("id",r).attr("data-inline-doc-type",o).addClass("dropzone");n.url=n.addRoute.replace("{orderId}",t).replace("{docType}",o),e.$documentOther.before(i);var d=i.dropzone(n);s("tbody tr",e.$documentOther).each(function(){var o=s(this).data("doc-id"),n=s("td",this).eq(0).text().replace(/\n/g," ");(n=n.trim())&&"-"!==n&&e.processExistingDocument(d,{id:o,orderId:t,name:n})})}}])&&a(t.prototype,o),n&&a(t,n),e}();window.addEventListener("DOMContentLoaded",function(e){var t=new c;t.cacheEls(),t.init()})}},[["uwo0","runtime",0,1]]]);